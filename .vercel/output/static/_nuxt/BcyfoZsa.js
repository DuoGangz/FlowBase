import{f as U,r as u,i as T,c as r,a as t,b as S,w as L,x as M,m as a,p as y,z as O,q as v,t as l,F as h,y as w,v as k,_ as V,o as d,d as C}from"#entry";import{u as N}from"./rBv2ZT4f.js";const E={class:"p-6 space-y-4"},R={class:"flex items-center justify-between"},B={class:"flex items-end gap-3"},F={key:0},q=["value"],A=["value"],H={class:"overflow-x-auto"},$={class:"min-w-full text-sm"},j={class:"py-2 pr-4"},z={class:"py-2 pr-4"},G={class:"py-2 pr-4"},J={class:"py-2 pr-4"},K={class:"py-2 pr-4"},P={class:"py-2 pr-4"},Z=U({__name:"time-report",setup(Q){const n=N(),x=u([]),c=u(""),p=u(""),i=u(),f=u([]);function g(o){return new Date(o).toLocaleDateString()}function m(o){return o?new Date(o).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}function D(o){if(!o.clockIn)return"-";const e=new Date(o.clockIn).getTime();let s=new Date(o.clockOut||Date.now()).getTime()-e;return o.lunchOut&&o.lunchIn&&(s-=new Date(o.lunchIn).getTime()-new Date(o.lunchOut).getTime()),(Math.max(0,s)/36e5).toFixed(2)}async function I(){if(n.role==="USER")return;const o=await $fetch("/api/users");n.role==="MANAGER"?f.value=o.filter(e=>e.id!==n.id):f.value=o.filter(e=>e.id!==n.id)}async function _(){x.value=await $fetch("/api/time-entries",{query:{userId:i.value||n.id,start:c.value||void 0,end:p.value||void 0}})}return T(async()=>{i.value=n.id,await I(),await _()}),(o,e)=>{const b=V;return d(),r("div",E,[t("div",R,[e[4]||(e[4]=t("h1",{class:"text-2xl font-semibold"},"Time Report",-1)),S(b,{to:"/",class:"underline"},{default:L(()=>[...e[3]||(e[3]=[C("Back",-1)])]),_:1})]),t("div",B,[a(n).role!=="USER"?(d(),r("div",F,[e[5]||(e[5]=t("label",{class:"block text-sm text-gray-600"},"User",-1)),y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>v(i)?i.value=s:null),class:"border rounded px-2 py-1 min-w-48"},[t("option",{value:a(n).id},"Me ("+l(a(n).name)+")",9,q),(d(!0),r(h,null,w(a(f),s=>(d(),r("option",{key:s.id,value:s.id},l(s.name)+" ("+l(s.role)+")",9,A))),128))],512),[[O,a(i),void 0,{number:!0}]])])):M("",!0),t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm text-gray-600"},"Start",-1)),y(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>v(c)?c.value=s:null),class:"border rounded px-2 py-1"},null,512),[[k,a(c)]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm text-gray-600"},"End",-1)),y(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>v(p)?p.value=s:null),class:"border rounded px-2 py-1"},null,512),[[k,a(p)]])]),t("button",{class:"px-3 py-2 border rounded-md",onClick:_},"Load")]),t("div",H,[t("table",$,[e[8]||(e[8]=t("thead",null,[t("tr",{class:"text-left border-b"},[t("th",{class:"py-2 pr-4"},"Date"),t("th",{class:"py-2 pr-4"},"Clock In"),t("th",{class:"py-2 pr-4"},"Lunch Out"),t("th",{class:"py-2 pr-4"},"Lunch In"),t("th",{class:"py-2 pr-4"},"Clock Out"),t("th",{class:"py-2 pr-4"},"Hours")])],-1)),t("tbody",null,[(d(!0),r(h,null,w(a(x),s=>(d(),r("tr",{key:s.id,class:"border-b"},[t("td",j,l(g(s.date)),1),t("td",z,l(m(s.clockIn)||"-"),1),t("td",G,l(m(s.lunchOut)||"-"),1),t("td",J,l(m(s.lunchIn)||"-"),1),t("td",K,l(m(s.clockOut)||"-"),1),t("td",P,l(D(s)),1)]))),128))])])])])}}});export{Z as default};
